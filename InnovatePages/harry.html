<!DOCTYPE html>
<html>
  <head>
    <title><%=name%>'s Agent</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.2.0/webcomponents-lite.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jdenticon@2.0.0"></script>
    <!--<link rel="import" href="bower_components/chat-window/chat-window.html">-->
    <style is="custom-style">
      chat-window {
          font-size: small;
          --chat-messages-height: 12em;
          --chat-messages-scroller: {
              border: 1px inset #eee;
          };
          --paper-input-container-input: {
              margin: 0 2px;
          };
          --chat-message-text: {
              background-color: #f0f0f0;
              padding: 6px 8px;
              margin: 4px 0;
              border-radius: 6px;
          };
      }
      @font-face {
        font-family: myFirstFont;
        src: url(/Users/user/Library/Fonts/Gilroy-Light.otf);
      }
      * {
        font-family: myFirstFont;
      }
      .center {
          margin:auto;
          width: 90%;
      }
      #messages { list-style-type: none; margin: 0; padding: 0; }
      #messages li { padding: 5px 10px; }
      #messages li:nth-child(odd) { background: #eee; }
      #messages { margin-bottom: 40px }
      .w3-bar { background-color: <%=theme%> !important }
      .theRow {margin-bottom: 20px;}
      .padding10 {padding: 10px;}
      #passportDetails, #drivingDetails, #employerDetails{display: none;}
      .w3-card-4:hover {cursor: pointer;}
      .notiContainer {position: relative;display: block; margin-top: 15px;}
      .notiBadge {position: absolute;display: block;top: -2px;right: -2px;font-size: 11px;
        width: 18px;
        height: 18px;
        padding: 3px;
        font-weight: bold;}
        .cred {font-size:13px;}
        .labelValue { font-weight: bolder; color: #333333;}
        .labelText { color: #615959;}
        .allowBtn, .rejectBtn {color: #FFF; border-radius: 3px; height: 25px; padding: 2px 16px;}
        .allowBtn:hover {background: #2196F3 !important; color: #fff !important;}
        .rejectBtn, .rejectBtn:hover {background: #666 !important; color:#fff !important;}
        .verifiedIcon {width: 20px; height: 20px; position: absolute; bottom: 6px; right: 3px;}
        input {width: 90% !important; height:30px; font-size: 13px;}
        label {font-size: 13px;}
    </style>
    </head>
    <body>
    <div id="relationships">
    <body style="max-width:400px;margin:16px;border:1px solid #ccc">
      <header class="w3-container w3-card-4 w3-theme">
          <div class="w3-col s9">
            <h3>Credential Wallet</h3>
          </div>
          <div class="w3-col s2">
            <h3><img src="./harry.png" alt="Avatar" style="width:50%"></div></h3>
        <div class="w3-col s1">
          <h3 onclick="document.getElementById('messages').style.display='block'">
            <span class="fa fa-bell-o notiContainer" style="font-size:25px;"><span class="w3-badge w3-red notiBadge">1</span></span>
          </h3> 
        </div>
      </header>
           
      <div id="proofRequirementSection" class="w3-panel">
        <div class="w3-card-4 padding10">
          <p><img src="./logo.png" alt="Logo" style="width: 120px; height: 31px; margin: -3px 0 0 0;"> is requesting for the below documents to create a new Account.</p>
          <ol class="w3-left-align">
            <li>Address & Phone Number</li>
            <li>Social Security Number or ITIN</li>
            <li>Current driver's license or other ID numbers</li>
            <li>You must be at least 13 years old to apply online</li>
          </ol>
          <div class="w3-row w3-center">
            <button class="w3-button w3-blue allowBtn">Allow</button>
            <button class="w3-button rejectBtn">Reject</button>
          </div>
        </div>
      </div>

      <div id="prefilledForm" class="w3-panel">
        <div class="w3-card-4 padding10">
          <form class="w3-margin applicationData">
            <div class="formSection"><p>Personal Information</p></div>
            <div class="w3-row w3-section" style="position: relative;">
              <div class="w3-rest">
                <label>Name</label>
                <input class="w3-input w3-border" type="text" placeholder="Full Name"><img src="./Tick.png" class="verifiedIcon" alt="badge" width="20%">
              </div>
            </div>
            <div class="w3-row w3-section">
              <div class="w3-rest">
                <label>Address</label>
                <textarea class="w3-input w3-border" style="resize:none"></textarea>
              </div>
            </div>
            <div class="w3-row w3-section">
              <div class="w3-rest">
                <label>Date of Birth</label>
                <input class="w3-input w3-border" type="text" placeholder="dd/mm/yyyy">
              </div>
            </div>
            <div class="w3-row w3-section">
              <div class="w3-rest">
                <label style="margin-right: 10px;">Gender</label>
                <input class="w3-radio" type="radio" name="gender" value="male" checked>
                <label style="margin: 0 0 0 -8px;">Male</label>

                <input class="w3-radio" type="radio" name="gender" value="female">
                <label style="margin: 0 0 0 -8px;">Female</label>

                <input class="w3-radio" type="radio" name="gender" value="" disabled>
                <label style="margin: 0 0 0 -8px;">Other</label>
              </div>
            </div>
            <div class="formSection"><p>Employment Information</p></div>
            <div class="w3-row w3-section">
              <div class="w3-rest">
                <label>Company</label>
                <input class="w3-input w3-border" type="text">
              </div>
            </div>
            <div class="w3-row w3-section">
              <div class="w3-rest">
                <label>Occupation</label>
                <select class="w3-select" name="option">
                  <option value="" disabled selected>Private</option>
                  <option value="1">Public</option>
                  <option value="2">Unemployed</option>
                  <option value="3">Business</option>
                </select>
              </div>
            </div>
            <div class="w3-row w3-section">
              <div class="w3-rest">
                <label>Salary Range</label>
                <select class="w3-select" name="option">
                  <option value="" disabled selected>$8,000 - $10,000</option>
                  <option value="1">$10,000 - $12,000 </option>
                  <option value="2">$12,000 - $14,000</option>
                  <option value="3">$14,000 and Above</option>
                </select>
              </div>
            </div>
            <div class="formSection"><p>Contact Information</p></div>
            <div class="w3-row w3-section">
              <div class="w3-rest">
                <label>Phone Number</label>
                <input class="w3-input w3-border" type="text">
              </div>
            </div>
            <div class="w3-row w3-section">
              <div class="w3-rest">
                <label>Email</label>
                <input class="w3-input w3-border" type="text">
              </div>
            </div>
            <div class="w3-row w3-center">
              <button class="w3-button w3-blue allowBtn">Continue</button>
              <button class="w3-button rejectBtn">Cancel</button>
            </div>
          </form>
        </div>
      </div>

      <div id="credentialSection" class="w3-panel">
        <div class="w3-row theRow" onclick="showHideCredDetails('passportDetails')">
          <div class="w3-card-4 padding10 cred">
            <div class="w3-container">
              <div class="w3-col s3">
                <img src="./passport.png" alt="badge" style="width: 38px; height: 53px;">
              </div>
              <div class="w3-col s9 w3-container">
                <h6>Passport</h6>
              </div>
              <div class="w3-row" id="passportDetails">
                <div class="w3-col s12 w3-text-left">
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Name:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      Harry Doe
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Passport ID:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      K1253523
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Address:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      door#292, xyz street, Bangalore - 560066
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Issued On:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      dd/mm/yyyy
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Expiry:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      dd/mm/yyyy
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Issued By:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      Republic of India
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Place of Issue:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      Bangalore
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="w3-row theRow" onclick="showHideCredDetails('drivingDetails')">
          <div class="w3-card-4 padding10 cred">
            <div class="w3-container">
              <div class="w3-col s3">
                  <img src="./dl.png" alt="badge" width="70%">
              </div>
              <div class="w3-col s9 w3-container">
                <h6>Driving Licence</h6>
              </div>
              <div class="w3-row" id="drivingDetails">
                <div class="w3-col s12">
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Name:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      Harry Doe
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Licence ID:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      dhfg/7362/6dg
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Address:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      vgdaf, bjh,fjhjhjj7-90909nh
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">DOB:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      dd/mm/yyyy
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Issued On:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      dd/mm/yyyy
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Expiry:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      dd/mm/yyyy
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="w3-row theRow" onclick="showHideCredDetails('employerDetails')">
          <div class="w3-card-4 padding10 cred">
            <div class="w3-container">
              <div class="w3-col s3">
                  <img src="./employer.png" alt="badge" width="70%">
              </div>
              <div class="w3-col s9 w3-container">
                <h6>Employment Proof from GE</h6>
              </div>
              <div class="w3-row" id="employerDetails">

                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Name:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      Harry Doe
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Company:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      Company Name
                    </div>
                  </div>
                  <div class="w3-row">
                    <div class="w3-col m4 l3">
                      <label class="labelText">Date of joining:</label>
                    </div>
                    <div class="w3-col m8 l9 labelValue">
                      dd/mm/yyyy
                    </div>
                  </div>
              </div>
            </div>
          </div>
        </div>
        <div id="notificationMessage" class="w3-modal">
          <div class="w3-modal-content">
            <div class="w3-container">
              <span onclick="document.getElementById('notificationMessage').style.display='none'"
              class="w3-button w3-display-topright">&times;</span>
              <p>Some text in the Modal..</p>
              <p>Some text in the Modal..</p>
            </div>
          </div>
        </div>

        <div id="messages" class="w3-container w3-card w3-center w3-animate-bottom" style="display:none;padding:20px;">
          <div style="margin-bottom: 15px;">NextGen Bank wants to access your personal and employment details from your wallet. Do you want to share?</div>
          <button class="w3-btn w3-blue" style="padding: 2px 10px;">Share</button>
          <button class="w3-btn w3-blue" style="padding: 2px 10px;">Cancel</button>
        </div>
    
      
      <footer class="w3-container w3-theme-l2" style="position:relative">
        <p style="text-align: center;color: white;">My Endpoint DID: <%=endpointDid%></p>
      </footer>
      </body>
      </div>

      
      <script>
        function showHideCredDetails(divName) {
          var x = document.getElementById(divName);
          if (x.style.display === "none") {
            x.style.display = "block";
          } else {
            x.style.display = "none";
          }
        }

        function showTab(id) {
            let tabs = document.getElementsByClassName("tab");
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].style.display = "none";
            }
            document.getElementById(id).style.display = "block";

            // Bold the selected link, unbold others
            let tabLinks = document.getElementsByClassName("tab_link");
            for (i = 0; i < tabLinks.length; i++) {
                tabLinks[i].style['font-weight'] = "normal";
            }

            document.getElementById(`${id}_link`).style['font-weight'] = "bold";
        }

        let tabs = document.getElementsByClassName("tab");
        let hashlink = document.location.hash.replace('#', '');
        let found = false;
        for(let tab of tabs) {
            if(tab.id === hashlink) {
                showTab(hashlink);
                found = true;
            }
        }
        if(!found) {
            window.location.href = window.location.href + "#credentials";
            showTab('relationships');
        }

        function request(url, method, message) {
            console.log(message);
            console.log(`${method}ing ${url}: ${message}`);
            let xhttp = new XMLHttpRequest();
            xhttp.open(method, url, true);
            if(message) {
                xhttp.setRequestHeader('Content-Type', 'application/json');
                xhttp.send(message);
            } else {
                xhttp.send();
            }
            location.reload();
        }

        showDiv(document.getElementById('currentProofRequest').value, 'proofRequestsClass');
        function showDiv(id, className) {
            let tabs = document.getElementsByClassName(className);
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].style.display = "none";
            }
            console.log('showing div: ', id);
            document.getElementById(id).style.display = "block";
        }

        function validateProof(div, proof) {
            div.innerHTML = '<i class="fa fa-spinner fa-spin" style="font-size:100px;"></i>'
            let xhttp = new XMLHttpRequest();
            xhttp.open('POST', '/api/proofs/validate', true);
            xhttp.setRequestHeader('Content-Type', 'application/json');
            console.log(proof);
            xhttp.send(JSON.stringify(proof));
            xhttp.onload = function() {
                console.log(xhttp);
                if(xhttp.status === 200) {
                    console.log("Validation succeeded");
                    div.innerHTML = '<i class="fa fa-check" style="color:green;font-size:120px;"></i>'
                } else {
                    div.innerHTML = '<i class="fa fa-times" style="color:red;font-size:120px;"></i>'
                    console.log("Validation failed");
                }
            }
        }

      </script>
      <script src="https://code.jquery.com/jquery-1.11.1.js"></script>

    </body>
</html>
